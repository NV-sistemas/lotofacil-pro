<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AgendeSeuHorario — Agendamento Online para Campos Society</title>
  <meta name="description" content="Agendamento online para campos society com sinal de 50%, protocolo e painel do dono. N&V Gestão Digital." />
  <style>
    :root{
      --text:#eef5ff;
      --muted:rgba(238,245,255,.72);
      --muted2:rgba(238,245,255,.62);
      --line:rgba(255,255,255,.12);
      --bg0:#020503;
      --bg1:#040806;
      --bg2:#050b08;
      --card:rgba(255,255,255,.03);
      --card2:rgba(0,0,0,.26);
      --green:#22c55e;
      --green2:#34d399;
      --radius:18px;
      --max:1120px;
      --shadow: 0 28px 120px rgba(0,0,0,.62);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Helvetica Neue", Helvetica;
      color:var(--text);
      background:
        radial-gradient(900px 420px at 26% 0%, rgba(34,197,94,.16), transparent 60%),
        radial-gradient(820px 420px at 80% 10%, rgba(34,197,94,.10), transparent 55%),
        linear-gradient(180deg, var(--bg1) 0%, var(--bg2) 100%);
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--max); margin:0 auto; padding:18px 16px 70px}
    .sr{position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden}

    /* Header */
    .top{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 14px;
      border:1px solid var(--line);
      border-radius: 999px;
      background: rgba(6,12,10,.65);
      backdrop-filter: blur(10px);
      position: sticky; top:12px; z-index:20;
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:950; letter-spacing:.2px}
    .dot{width:10px;height:10px;border-radius:999px;background:var(--green);display:inline-block}
    .pill{
      font-size:12px; font-weight:900; color:rgba(238,245,255,.78);
      border:1px solid var(--line);
      padding:6px 10px; border-radius:999px;
      background: rgba(255,255,255,.03);
    }
    .nav{display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end}
    .nav a{
      color:rgba(238,245,255,.80);
      font-weight:850; font-size:14px;
      padding:8px 10px; border-radius:14px;
      opacity:.86;
    }
    .nav a:hover{opacity:1; background: rgba(255,255,255,.04)}

    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:10px;
      padding:12px 14px; border-radius: 14px; border:1px solid var(--line);
      background: rgba(255,255,255,.04); font-weight:950;
      cursor:pointer;
    }
    .btn:hover{filter:brightness(1.08)}
    .btn.primary{border:0; color:#05120b; background: linear-gradient(135deg, var(--green2), var(--green))}
    .btn.ghost{background:transparent}
    .btn.small{padding:10px 12px; font-size:13px; border-radius:14px}

    /* Hero */
    .hero{
      margin-top:14px;
      border:1px solid var(--line);
      border-radius: 28px;
      overflow:hidden;
      position:relative;
      box-shadow: var(--shadow);
      background:
        radial-gradient(900px 480px at 20% 10%, rgba(34,197,94,.18), transparent 55%),
        radial-gradient(820px 520px at 85% 0%, rgba(34,197,94,.10), transparent 55%),
        linear-gradient(180deg, rgba(0,0,0,.20), rgba(0,0,0,.68));
    }
    /* Campo (linhas) */
    .hero::after{
      content:"";
      position:absolute; inset:0;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='700' viewBox='0 0 1200 700'%3E%3Cg fill='none' stroke='%23FFFFFF' stroke-opacity='.16' stroke-width='4'%3E%3Crect x='60' y='60' width='1080' height='580' rx='18'/%3E%3Cline x1='600' y1='60' x2='600' y2='640'/%3E%3Ccircle cx='600' cy='350' r='120'/%3E%3Ccircle cx='600' cy='350' r='8' fill='%23FFFFFF' fill-opacity='.16' stroke='none'/%3E%3Crect x='60' y='210' width='140' height='280' rx='10'/%3E%3Crect x='1000' y='210' width='140' height='280' rx='10'/%3E%3Crect x='60' y='265' width='60' height='170' rx='10'/%3E%3Crect x='1080' y='265' width='60' height='170' rx='10'/%3E%3C/g%3E%3C/svg%3E");
      background-size: cover;
      background-position: center;
      opacity:.75;
      mix-blend-mode: screen;
      pointer-events:none;
    }
    .hero::before{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(90deg, rgba(0,0,0,.78) 0%, rgba(0,0,0,.46) 55%, rgba(0,0,0,.74) 100%);
      pointer-events:none;
    }
    .heroIn{
      position:relative;
      padding:48px 22px;
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap:18px;
      align-items:center;
    }
    @media (max-width: 920px){ .heroIn{grid-template-columns:1fr; padding:34px 18px} }

    h1{margin:8px 0 10px;font-size: clamp(30px, 4.2vw, 56px); line-height:1.02; letter-spacing:-.6px}
    .sub{margin:0 0 18px;color: rgba(238,245,255,.84);font-size:16px;line-height:1.75;max-width: 62ch}
    .ctaRow{display:flex; gap:12px; flex-wrap:wrap; margin:18px 0 0}
    .note{margin-top:10px; color: rgba(238,245,255,.64); font-size:12px}

    .card{
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: var(--card);
      padding:18px;
    }
    .heroCard{background: rgba(0,0,0,.30)}
    .heroCard h3{margin:0 0 12px; font-size:16px}
    ul{margin:0; padding-left:18px; color:rgba(238,245,255,.72); line-height:1.85}
    .logoBox{
      display:flex; align-items:center; justify-content:flex-end;
      margin-bottom:10px;
    }
    .logoFake{
      width:240px; max-width:100%;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.10);
      background: radial-gradient(520px 220px at 50% 0%, rgba(34,197,94,.28), transparent 60%), rgba(0,0,0,.40);
      padding:18px 16px;
      box-shadow: 0 18px 70px rgba(0,0,0,.55);
      text-align:center;
    }
    .logoFake b{display:block; font-weight:1000; letter-spacing:.6px; font-size:22px}
    .logoFake small{display:block; margin-top:6px; color:rgba(238,245,255,.70); font-weight:850}
    .logoMark{
      display:inline-block;
      width:56px; height:56px; border-radius:16px;
      border:2px solid rgba(34,197,94,.85);
      position:relative;
      margin:0 auto 10px;
      transform: rotate(0deg);
    }
    .logoMark::before{
      content:"";
      position:absolute; inset:12px;
      border:2px solid rgba(34,197,94,.85);
      border-top:0; border-right:0;
      transform: rotate(35deg);
    }

    /* Sections */
    .section{ padding:28px 0 0; }
    .section .card{background: rgba(255,255,255,.025)}
    h2{margin:0 0 10px; font-size:22px}
    .muted{color:var(--muted); line-height:1.7}
    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:14px}
    @media (max-width: 920px){ .grid2{grid-template-columns:1fr} }

    /* Contact bar */
    .contactBar{
      display:flex; align-items:center; justify-content:space-between; gap:14px; flex-wrap:wrap;
      padding:18px;
      border:1px solid var(--line);
      border-radius: 18px;
      background: rgba(0,0,0,.24);
    }
    .contactEmail{
      font-weight:950;
      letter-spacing:.2px;
      color: rgba(238,245,255,.88);
    }
    footer{
      margin-top:18px; padding-top:16px; border-top:1px solid var(--line);
      color:rgba(238,245,255,.62); font-size:13px;
      display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap
    }
  
    /* Admin */
    .admHidden{display:none !important}
    .admShell{
      margin-top:18px;
      border:1px solid var(--line);
      border-radius: 24px;
      overflow:hidden;
      background: rgba(0,0,0,.28);
      box-shadow: var(--shadow);
    }
    .admTop{
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
      padding:14px 16px;
      border-bottom:1px solid var(--line);
      background: rgba(6,12,10,.55);
      backdrop-filter: blur(10px);
    }
    .admTop b{font-weight:1000}
    .admTabs{display:flex; gap:8px; flex-wrap:wrap}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      font-weight:950;
      font-size:13px;
      cursor:pointer;
      opacity:.88;
      user-select:none;
    }
    .chip:hover{opacity:1; filter:brightness(1.08)}
    .chip.active{
      border:0;
      color:#05120b;
      background: linear-gradient(135deg, var(--green2), var(--green));
      opacity:1;
    }
    .admBody{padding:16px}
    .row{display:grid; grid-template-columns: 1fr 1fr; gap:14px}
    @media (max-width: 920px){ .row{grid-template-columns:1fr} }
    .field{display:flex; flex-direction:column; gap:6px; margin-bottom:12px}
    label{font-size:12px; color:rgba(238,245,255,.72); font-weight:900; letter-spacing:.2px}
    input, select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.30);
      color:var(--text);
      outline:none;
      font-weight:850;
    }
    textarea{min-height:92px; resize:vertical; line-height:1.5}
    input:focus, select:focus, textarea:focus{border-color: rgba(34,197,94,.55); box-shadow: 0 0 0 3px rgba(34,197,94,.12)}
    .kpiGrid{display:grid; grid-template-columns: repeat(4, 1fr); gap:12px}
    @media (max-width: 920px){ .kpiGrid{grid-template-columns:1fr 1fr} }
    .kpi{
      border:1px solid var(--line);
      border-radius: 18px;
      background: rgba(255,255,255,.02);
      padding:14px;
    }
    .kpi small{display:block;color:rgba(238,245,255,.62);font-weight:900}
    .kpi b{display:block;font-size:22px;margin-top:6px}
    .table{
      width:100%;
      border-collapse: collapse;
      overflow:hidden;
      border-radius: 16px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.20);
    }
    .table th,.table td{
      padding:10px 10px;
      border-bottom:1px solid rgba(255,255,255,.08);
      text-align:left;
      font-size:13px;
      vertical-align:top;
    }
    .table th{color:rgba(238,245,255,.78);font-weight:1000}
    .table td{color:rgba(238,245,255,.72);font-weight:850}
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      padding:6px 10px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      font-weight:1000;
      font-size:12px;
      white-space:nowrap;
    }
    .badge.ok{border-color: rgba(34,197,94,.35); background: rgba(34,197,94,.10)}
    .badge.warn{border-color: rgba(245,158,11,.35); background: rgba(245,158,11,.10)}
    .badge.block{border-color: rgba(239,68,68,.35); background: rgba(239,68,68,.10)}
    .actions{display:flex; gap:8px; flex-wrap:wrap}
    .hint{font-size:12px; color:rgba(238,245,255,.62); line-height:1.55}
    .hr{height:1px; background: rgba(255,255,255,.10); margin:14px 0}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
    .qrcodeBox{
      border:1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      padding:14px;
      background: rgba(0,0,0,.22);
      display:flex; gap:14px; flex-wrap:wrap; align-items:flex-start;
    }
    .qrcodeCanvas{
      width:164px; min-height:164px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      display:flex; align-items:center; justify-content:center;
    }
    .toast{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 18px;
      background: rgba(0,0,0,.78);
      border:1px solid rgba(255,255,255,.14);
      color: rgba(238,245,255,.90);
      padding: 12px 14px;
      border-radius: 14px;
      font-weight: 950;
      font-size: 13px;
      z-index: 9999;
      display:none;
      backdrop-filter: blur(10px);
    }

  </style>
</head>

<body>
  <div class="wrap">
    <header class="top">
      <div class="brand" aria-label="Marca">
        <span class="dot" aria-hidden="true"></span>
        <span>AgendeSeuHorario</span>
        <span class="pill">para Campos Society</span>
      </div>

      <nav class="nav" aria-label="Navegação">
        <a href="#quem-somos">Quem somos</a>
        <a href="#vantagens">Vantagens</a>
        <a href="#adm" id="navAdm" class="btn ghost small" style="padding:10px 12px;border-radius:14px">ADM</a>
        <a class="btn primary small" href="#contato">Contato</a>
      </nav>
    </header>

    <main>
      <section class="hero" aria-label="Capa">
        <div class="heroIn">
          <div>
            <h1>Agendamento online<br>que organiza a rotina do<br>seu campo.</h1>

            <p class="sub">
              O cliente reserva sozinho, paga o <b>sinal</b> para confirmar e recebe <b>protocolo</b>.
              O dono acompanha agenda, mensalistas e receitas em um painel simples — reduzindo tempo no WhatsApp e evitando furos.
            </p>

            <div class="ctaRow">
              <a class="btn primary" href="#vantagens">Ver o que entrega</a>
              <a class="btn ghost" href="#contato">Falar com a N&V</a>
            </div>

            <div class="note">
              *Sem preços no site: apresentação e parceria são feitas pessoalmente.
            </div>
          </div>

          <div class="card heroCard">
            <div class="logoBox">
              <div class="logoFake" aria-label="Logo N&V (placeholder)">
                <span class="logoMark" aria-hidden="true"></span>
                <b>N&V</b>
                <small>GESTÃO DIGITAL<br><span style="opacity:.9">— AgendeSeuHorario —</span></small>
              </div>
            </div>

            <h3>Como funciona (resumo)</h3>
            <ul>
              <li>Cliente escolhe <b>data</b> / <b>horário</b> / <b>período</b> (60, 90, 120+)</li>
              <li>Cadastro rápido e aceite do termo</li>
              <li>Pagamento de <b>50% de sinal</b> para confirmar</li>
              <li>Protocolo automático + lembrete 1h antes</li>
              <li>Painel do dono com agenda e controles</li>
            </ul>
          </div>
        </div>
      </section>

      <section id="quem-somos" class="section" aria-label="Quem somos">
        <div class="card">
          <h2>Quem somos</h2>
          <p class="muted" style="margin:0">
            A <b>N&V Gestão Digital</b> é uma empresa conceituada em <b>automação de agendamentos online para campos society</b>,
            desenvolvendo sistemas que transformam atendimento em <b>processo</b>.<br><br>
            Com o <b>AgendeSeuHorario</b>, o dono do campo ganha <b>controle</b>, o cliente ganha <b>praticidade</b>,
            e a operação funciona com mais <b>organização</b>, <b>rapidez</b> e <b>segurança</b>.
          </p>
        </div>
      </section>

      <section id="vantagens" class="section" aria-label="Vantagens">
        <div class="card">
          <h2>O que o sistema entrega</h2>
          <p class="muted" style="margin:0 0 14px">
            Uma solução completa para modernizar o atendimento, automatizar reservas e dar previsibilidade ao seu campo society.
          </p>

          <div class="grid2">
            <div class="card" style="background:rgba(0,0,0,.20)">
              <h3 style="margin:0 0 10px">Para o dono</h3>
              <ul>
                <li>Agenda digital organizada</li>
                <li>Controle de horários ocupados e vagos</li>
                <li>Cadastro de mensalistas</li>
                <li>Controle de receitas</li>
                <li>Confirmação automática</li>
                <li>Redução de desistências</li>
              </ul>
            </div>

            <div class="card" style="background:rgba(0,0,0,.20)">
              <h3 style="margin:0 0 10px">Para o cliente</h3>
              <ul>
                <li>Reserva online</li>
                <li>Escolha de período (60 / 90 / 120 minutos)</li>
                <li>Pagamento de 50% de sinal</li>
                <li>Protocolo de confirmação</li>
                <li>Lembrete automático 1h antes</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <section id="contato" class="section" aria-label="Contato">
        <div class="contactBar">
          <div>
            <div style="font-weight:1000; font-size:18px; margin-bottom:4px">Contato</div>
            <div class="muted">Demonstração e parceria: apresentação presencial.</div>
          </div>

          <div class="contactEmail">contato@agendecampo.com.br</div>

          <a class="btn primary" href="mailto:contato@agendecampo.com.br?subject=Parceria%20AgendeSeuHorario">Enviar e-mail</a>
        </div>

        <footer>
          <div>© 2026 N&V Gestão Digital</div>
          <div class="muted">AgendeCampo.com.br</div>
        </footer>
      
      <section id="adm" class="section" aria-label="ADM (interno)">
        <div class="admShell" id="admShell">
          <div class="admTop">
            <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
              <span class="dot" aria-hidden="true"></span>
              <b>ADM — N&V Gestão Digital</b>
              <span class="pill">controle de clientes</span>
            </div>
            <div class="actions">
              <button class="btn small" id="btnAdmLogout" type="button" style="display:none">Sair</button>
            </div>
          </div>

          <div class="admBody">
            <!-- Login -->
            <div id="admLoginView">
              <div class="row">
                <div class="card" style="background:rgba(0,0,0,.22)">
                  <h2 style="margin:0 0 6px">Acesso administrativo</h2>
                  <div class="hint">
                    Use o login abaixo para entrar no painel. Depois você pode mudar a senha.
                    <br><span class="mono">admin@agendecampo.com.br</span> / <span class="mono">123456</span>
                  </div>
                  <div class="hr"></div>

                  <div class="field">
                    <label for="admEmail">E-mail</label>
                    <input id="admEmail" type="email" autocomplete="username" placeholder="admin@agendecampo.com.br">
                  </div>
                  <div class="field">
                    <label for="admPass">Senha</label>
                    <input id="admPass" type="password" autocomplete="current-password" placeholder="••••••">
                  </div>
                  <div class="actions">
                    <button class="btn primary" id="btnAdmLogin" type="button">Entrar</button>
                    <button class="btn" id="btnAdmOpenChange" type="button">Mudar senha</button>
                  </div>
                </div>

                <div class="card" style="background:rgba(0,0,0,.22)">
                  <h2 style="margin:0 0 6px">Como funciona aqui</h2>
                  <div class="hint">
                    Este painel é <b>interno</b> e serve para:
                    <ul style="margin-top:8px">
                      <li>Gerenciar clientes (ativos/inativos)</li>
                      <li>Gerar cobrança mensal via <b>PIX</b> (QR Code + Copia e Cola)</li>
                      <li>Controlar atraso: alertas (1º dia, 3º dia) e bloqueio (5º dia)</li>
                      <li>Criar “sub-sites” (gerar um <b>index.html</b> do cliente para você subir)</li>
                    </ul>
                    <div class="hint" style="margin-top:10px">
                      Observação: por enquanto os dados ficam no seu navegador (<b>localStorage</b>).
                      Quando formos para a fase SaaS, conectamos tudo ao banco e autenticação.
                    </div>
                  </div>
                </div>
              </div>

              <div class="admShell" style="margin-top:14px;border-radius:18px;overflow:hidden">
                <div class="admBody">
                  <h2 style="margin:0 0 6px">Troca de senha</h2>
                  <div class="hint">A senha é alterada apenas para este dispositivo/navegador (modo provisório).</div>
                  <div class="row" style="margin-top:12px">
                    <div>
                      <div class="field">
                        <label for="chgEmail">E-mail ADM</label>
                        <input id="chgEmail" type="email" value="admin@agendecampo.com.br">
                      </div>
                      <div class="field">
                        <label for="chgOld">Senha atual</label>
                        <input id="chgOld" type="password" placeholder="••••••">
                      </div>
                    </div>
                    <div>
                      <div class="field">
                        <label for="chgNew">Nova senha</label>
                        <input id="chgNew" type="password" placeholder="mín. 6 caracteres">
                      </div>
                      <div class="field">
                        <label for="chgNew2">Confirmar nova senha</label>
                        <input id="chgNew2" type="password" placeholder="repita a nova senha">
                      </div>
                    </div>
                  </div>
                  <div class="actions">
                    <button class="btn primary" id="btnAdmChange" type="button">Salvar nova senha</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Dashboard -->
            <div id="admDashView" style="display:none">
              <div class="kpiGrid">
                <div class="kpi"><small>Clientes ativos</small><b id="kpiAtivos">0</b></div>
                <div class="kpi"><small>Clientes inativos</small><b id="kpiInativos">0</b></div>
                <div class="kpi"><small>Em alerta</small><b id="kpiAlertas">0</b></div>
                <div class="kpi"><small>Bloqueados</small><b id="kpiBloq">0</b></div>
              </div>

              <div class="hr"></div>

              <div class="admTabs" role="tablist" aria-label="Abas ADM">
                <div class="chip active" data-tab="clientes">Clientes</div>
                <div class="chip" data-tab="cobrancas">Cobranças / PIX</div>
                <div class="chip" data-tab="novo">Adicionar cliente</div>
                <div class="chip" data-tab="config">Configurações</div>
              </div>

              <div class="hr"></div>

              <!-- Clientes -->
              <div id="tab_clientes">
                <div class="card" style="background:rgba(0,0,0,.22)">
                  <h2 style="margin:0 0 6px">Clientes</h2>
                  <div class="hint">A cobrança é sempre enviada no início do mês (referente ao mês anterior), com vencimento até dia 10.</div>
                  <div class="hr"></div>
                  <div style="overflow:auto">
                    <table class="table" aria-label="Tabela de clientes">
                      <thead>
                        <tr>
                          <th>Society</th>
                          <th>Status</th>
                          <th>Vencimento</th>
                          <th>Atraso</th>
                          <th>Ações</th>
                        </tr>
                      </thead>
                      <tbody id="tblClientes"></tbody>
                    </table>
                  </div>
                </div>
              </div>

              <!-- Cobranças -->
              <div id="tab_cobrancas" style="display:none">
                <div class="row">
                  <div class="card" style="background:rgba(0,0,0,.22)">
                    <h2 style="margin:0 0 6px">Gerar cobrança PIX</h2>
                    <div class="hint">
                      Preencha os dados e gere o <b>QR Code</b> + <b>PIX Copia e Cola</b>.
                      Você pode vincular a cobrança a um cliente.
                    </div>
                    <div class="hr"></div>

                    <div class="field">
                      <label for="pixCliente">Vincular ao cliente</label>
                      <select id="pixCliente"></select>
                    </div>
                    <div class="field">
                      <label for="pixValor">Valor (R$)</label>
                      <input id="pixValor" type="number" min="0" step="0.01" placeholder="Ex: 89.90">
                    </div>
                    <div class="row">
                      <div class="field">
                        <label for="pixVenc">Vencimento</label>
                        <input id="pixVenc" type="date">
                      </div>
                      <div class="field">
                        <label for="pixTxid">TXID (identificador)</label>
                        <input id="pixTxid" type="text" placeholder="Ex: MENSALIDADE-2026-03">
                      </div>
                    </div>
                    <div class="field">
                      <label for="pixDesc">Descrição (opcional)</label>
                      <input id="pixDesc" type="text" placeholder="Ex: Mensalidade AgendeCampo">
                    </div>

                    <div class="hr"></div>

                    <h3 style="margin:0 0 8px; font-size:16px">Chave PIX (N&V)</h3>
                    <div class="field">
                      <label for="pixKey">Chave PIX</label>
                      <input id="pixKey" type="text" placeholder="Sua chave PIX (e-mail, telefone, aleatória ou CPF/CNPJ)">
                    </div>
                    <div class="row">
                      <div class="field">
                        <label for="pixNome">Nome (recebedor)</label>
                        <input id="pixNome" type="text" placeholder="N&V GESTAO DIGITAL">
                      </div>
                      <div class="field">
                        <label for="pixCidade">Cidade</label>
                        <input id="pixCidade" type="text" placeholder="SAO PAULO">
                      </div>
                    </div>

                    <div class="actions">
                      <button class="btn primary" id="btnGerarPix" type="button">Gerar QR Code</button>
                      <button class="btn" id="btnCopiarPix" type="button">Copiar Copia e Cola</button>
                      <button class="btn" id="btnMarcarPago" type="button">Marcar como pago</button>
                    </div>
                  </div>

                  <div class="card" style="background:rgba(0,0,0,.22)">
                    <h2 style="margin:0 0 6px">QR Code + Copia e Cola</h2>
                    <div class="qrcodeBox">
                      <div class="qrcodeCanvas" id="qrcode"></div>
                      <div style="flex:1; min-width:240px">
                        <div class="hint">PIX Copia e Cola:</div>
                        <textarea id="pixPayload" class="mono" readonly></textarea>
                        <div class="hint" style="margin-top:8px">
                          Dica: envie o QR Code e o “Copia e Cola” no WhatsApp do cliente.
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Novo cliente -->
              <div id="tab_novo" style="display:none">
                <div class="card" style="background:rgba(0,0,0,.22)">
                  <h2 style="margin:0 0 6px">Adicionar novo cliente</h2>
                  <div class="hint">
                    Fluxo sugerido: escolher layout → enviar imagem de fundo (grande) → adicionar 6 fotos com resumos → dados do society.
                    Ao final, este painel gera um <b>index.html</b> para você baixar e subir no ar.
                  </div>
                  <div class="hr"></div>

                  <div class="row">
                    <div>
                      <div class="field">
                        <label for="cliNome">Nome do Society</label>
                        <input id="cliNome" type="text" placeholder="Ex: Arena do Bairro">
                      </div>
                      <div class="field">
                        <label for="cliTelefone">Telefone / WhatsApp</label>
                        <input id="cliTelefone" type="text" placeholder="Ex: (11) 99999-9999">
                      </div>
                      <div class="field">
                        <label for="cliEndereco">Endereço completo</label>
                        <input id="cliEndereco" type="text" placeholder="Rua, número, bairro, cidade/UF">
                      </div>
                      <div class="field">
                        <label for="cliLayout">Layout</label>
                        <select id="cliLayout">
                          <option value="modelo-1-hero-impacto">modelo-1-hero-impacto</option>
                          <option value="modelo-3-corporativo">modelo-3-corporativo</option>
                          <option value="modelo-5-parallax">modelo-5-parallax</option>
                        </select>
                      </div>
                      <div class="field">
                        <label for="cliBg">Foto de fundo (principal)</label>
                        <input id="cliBg" type="file" accept="image/*">
                        <div class="hint">Sugestão: 1600×900 ou maior (JPG/PNG).</div>
                      </div>
                    </div>

                    <div>
                      <div class="field">
                        <label>6 fotos + resumos</label>
                        <div class="hint">Adicione as imagens (JPG/PNG) e um texto curto para cada uma.</div>
                      </div>

                      <div class="row">
                        <div class="field">
                          <label for="p1">Foto 1</label>
                          <input id="p1" type="file" accept="image/*">
                          <input id="t1" type="text" placeholder="Resumo 1">
                        </div>
                        <div class="field">
                          <label for="p2">Foto 2</label>
                          <input id="p2" type="file" accept="image/*">
                          <input id="t2" type="text" placeholder="Resumo 2">
                        </div>
                        <div class="field">
                          <label for="p3">Foto 3</label>
                          <input id="p3" type="file" accept="image/*">
                          <input id="t3" type="text" placeholder="Resumo 3">
                        </div>
                        <div class="field">
                          <label for="p4">Foto 4</label>
                          <input id="p4" type="file" accept="image/*">
                          <input id="t4" type="text" placeholder="Resumo 4">
                        </div>
                        <div class="field">
                          <label for="p5">Foto 5</label>
                          <input id="p5" type="file" accept="image/*">
                          <input id="t5" type="text" placeholder="Resumo 5">
                        </div>
                        <div class="field">
                          <label for="p6">Foto 6</label>
                          <input id="p6" type="file" accept="image/*">
                          <input id="t6" type="text" placeholder="Resumo 6">
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="actions" style="margin-top:8px">
                    <button class="btn primary" id="btnSalvarCliente" type="button">Salvar cliente</button>
                    <button class="btn" id="btnGerarIndex" type="button">Gerar index.html do cliente</button>
                  </div>

                  <div class="hr"></div>

                  <h3 style="margin:0 0 8px; font-size:16px">Prévia / saída</h3>
                  <div class="hint">Aqui aparecerá o HTML gerado para download.</div>
                  <textarea id="outIndex" class="mono" readonly style="min-height:180px"></textarea>
                  <div class="actions">
                    <button class="btn" id="btnBaixarIndex" type="button">Baixar index.html</button>
                  </div>
                </div>
              </div>

              <!-- Config -->
              <div id="tab_config" style="display:none">
                <div class="card" style="background:rgba(0,0,0,.22)">
                  <h2 style="margin:0 0 6px">Configurações</h2>
                  <div class="hint">
                    Ajustes gerais do ADM (provisório).
                  </div>
                  <div class="hr"></div>

                  <div class="row">
                    <div>
                      <h3 style="margin:0 0 8px; font-size:16px">Regras de cobrança</h3>
                      <div class="hint">
                        • Vencimento padrão: dia 10<br>
                        • Atrasou 1 dia: alerta de bloqueio<br>
                        • Atrasou 3 dias: novo alerta<br>
                        • Atrasou 5 dias: bloqueio do agendamento online e acesso do dono
                      </div>
                    </div>
                    <div>
                      <h3 style="margin:0 0 8px; font-size:16px">Dados PIX</h3>
                      <div class="hint">Esses dados preenchem automaticamente o gerador de cobrança.</div>
                      <div class="field">
                        <label for="cfgPixKey">Chave PIX</label>
                        <input id="cfgPixKey" type="text" placeholder="Sua chave PIX">
                      </div>
                      <div class="row">
                        <div class="field">
                          <label for="cfgPixNome">Nome</label>
                          <input id="cfgPixNome" type="text" placeholder="N&V GESTAO DIGITAL">
                        </div>
                        <div class="field">
                          <label for="cfgPixCidade">Cidade</label>
                          <input id="cfgPixCidade" type="text" placeholder="SAO PAULO">
                        </div>
                      </div>
                      <div class="actions">
                        <button class="btn primary" id="btnSalvarCfgPix" type="button">Salvar PIX padrão</button>
                        <button class="btn" id="btnResetDados" type="button">Resetar dados (local)</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </section>

      <div class="toast" id="toast"></div>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
      <script>
        (function(){
          const LS_AUTH = "agc_adm_auth_v1";
          const LS_DATA = "agc_adm_data_v1";

          // ---------- Helpers ----------
          const $ = (id)=>document.getElementById(id);
          const fmtMoney = (v)=>{
            const n = Number(v || 0);
            return n.toLocaleString("pt-BR", {style:"currency", currency:"BRL"});
          };
          const todayISO = ()=> new Date().toISOString().slice(0,10);
          const daysBetween = (a,b)=> Math.floor((b - a) / (1000*60*60*24));
          const safeUpper = (s)=> String(s||"").toUpperCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/[^A-Z0-9 \-\.]/g,"").trim().slice(0,25);
          const toast = (msg)=>{
            const el = $("toast");
            el.textContent = msg;
            el.style.display = "block";
            clearTimeout(window.__t);
            window.__t = setTimeout(()=> el.style.display="none", 2200);
          };
          const dl = (filename, content)=>{
            const blob = new Blob([content], {type:"text/html;charset=utf-8"});
            const a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            setTimeout(()=>{ URL.revokeObjectURL(a.href); a.remove(); }, 0);
          };
          const fileToDataURL = (file)=> new Promise((res,rej)=>{
            if(!file){ return res(""); }
            const r = new FileReader();
            r.onload = ()=>res(String(r.result||""));
            r.onerror = rej;
            r.readAsDataURL(file);
          });

          // ---------- Default data ----------
          const defaultAuth = { email:"admin@agendecampo.com.br", pass:"123456" };
          const defaultData = {
            cfgPix: { key:"", nome:"N&V GESTAO DIGITAL", cidade:"SAO PAULO" },
            clients: [
              // exemplo (você pode apagar)
              // { id:"arena-exemplo", nome:"Arena Exemplo", ativo:true, vencimento:"2026-03-10", telefone:"", endereco:"", layout:"modelo-1-hero-impacto", bloqueado:false, pagoEm:null }
            ],
            lastPix: { payload:"", clientId:"", venc:"", valor:"", txid:"", desc:"" }
          };

          const loadAuth = ()=> {
            const raw = localStorage.getItem(LS_AUTH);
            if(!raw){ localStorage.setItem(LS_AUTH, JSON.stringify(defaultAuth)); return {...defaultAuth}; }
            try { return JSON.parse(raw) || {...defaultAuth}; } catch(e){ return {...defaultAuth}; }
          };
          const saveAuth = (a)=> localStorage.setItem(LS_AUTH, JSON.stringify(a));

          const loadData = ()=>{
            const raw = localStorage.getItem(LS_DATA);
            if(!raw){ localStorage.setItem(LS_DATA, JSON.stringify(defaultData)); return structuredClone(defaultData); }
            try { return JSON.parse(raw) || structuredClone(defaultData); } catch(e){ return structuredClone(defaultData); }
          };
          const saveData = (d)=> localStorage.setItem(LS_DATA, JSON.stringify(d));

          let AUTH = loadAuth();
          let DATA = loadData();

          // ---------- Tabs ----------
          function setTab(name){
            ["clientes","cobrancas","novo","config"].forEach(t=>{
              const el = $("tab_"+t);
              if(el) el.style.display = (t===name) ? "block" : "none";
            });
            document.querySelectorAll(".chip[data-tab]").forEach(ch=>{
              ch.classList.toggle("active", ch.getAttribute("data-tab")===name);
            });
          }

          // ---------- Billing status ----------
          function calcStatus(cli){
            // se inativo, sem cobrança
            if(!cli.ativo) return {label:"Inativo", cls:"", atraso:0, bloqueado:false};
            const venc = cli.vencimento ? new Date(cli.vencimento+"T00:00:00") : null;
            const now = new Date();
            if(!venc) return {label:"Ativo (sem vencimento)", cls:"warn", atraso:0, bloqueado:false};

            // pago após vencimento? se pagoEm >= venc, ok.
            if(cli.pagoEm){
              const pago = new Date(cli.pagoEm);
              if(pago >= venc){
                return {label:"Pago", cls:"ok", atraso:0, bloqueado:false};
              }
            }

            const atraso = Math.max(0, daysBetween(venc, now));
            if(atraso >= 5) return {label:"Bloqueado", cls:"block", atraso, bloqueado:true};
            if(atraso >= 3) return {label:"Alerta (3 dias)", cls:"warn", atraso, bloqueado:false};
            if(atraso >= 1) return {label:"Alerta (1 dia)", cls:"warn", atraso, bloqueado:false};
            return {label:"Em dia", cls:"ok", atraso:0, bloqueado:false};
          }

          function refreshKPIs(){
            const ativos = DATA.clients.filter(c=>c.ativo).length;
            const inativos = DATA.clients.filter(c=>!c.ativo).length;
            const alertas = DATA.clients.filter(c=> c.ativo && [1,2,3,4].includes(calcStatus(c).atraso)).length;
            const bloqueados = DATA.clients.filter(c=> c.ativo && calcStatus(c).bloqueado).length;
            $("kpiAtivos").textContent = ativos;
            $("kpiInativos").textContent = inativos;
            $("kpiAlertas").textContent = alertas;
            $("kpiBloq").textContent = bloqueados;
          }

          function refreshClientsTable(){
            const tbody = $("tblClientes");
            tbody.innerHTML = "";
            DATA.clients.forEach(cli=>{
              const st = calcStatus(cli);
              const tr = document.createElement("tr");

              const tdNome = document.createElement("td");
              tdNome.innerHTML = "<b style='color:rgba(238,245,255,.88)'>" + (cli.nome||"-") + "</b><div class='hint' style='margin-top:4px'>"+(cli.id||"")+"</div>";
              const tdSt = document.createElement("td");
              tdSt.innerHTML = "<span class='badge "+(st.cls||"")+"'>"+st.label+"</span>";
              const tdV = document.createElement("td");
              tdV.textContent = cli.vencimento ? cli.vencimento : "-";
              const tdA = document.createElement("td");
              tdA.textContent = st.atraso ? (st.atraso + " dia(s)") : "0";
              const tdAc = document.createElement("td");

              const btnToggle = document.createElement("button");
              btnToggle.className = "btn small";
              btnToggle.type = "button";
              btnToggle.textContent = cli.ativo ? "Desativar" : "Ativar";
              btnToggle.onclick = ()=>{
                cli.ativo = !cli.ativo;
                saveData(DATA);
                renderAll();
                toast("Cliente atualizado.");
              };

              const btnPago = document.createElement("button");
              btnPago.className = "btn small";
              btnPago.type = "button";
              btnPago.textContent = "Marcar pago";
              btnPago.onclick = ()=>{
                cli.pagoEm = new Date().toISOString();
                // próximo vencimento sugerido: dia 10 do próximo mês
                const dt = new Date();
                dt.setMonth(dt.getMonth()+1);
                const y = dt.getFullYear();
                const m = String(dt.getMonth()+1).padStart(2,"0");
                cli.vencimento = y + "-" + m + "-10";
                saveData(DATA);
                renderAll();
                toast("Pagamento registrado.");
              };

              const btnCobrar = document.createElement("button");
              btnCobrar.className = "btn small";
              btnCobrar.type = "button";
              btnCobrar.textContent = "Cobrar PIX";
              btnCobrar.onclick = ()=>{
                setTab("cobrancas");
                $("pixCliente").value = cli.id;
                $("pixVenc").value = cli.vencimento || "";
                toast("Cliente selecionado no PIX.");
              };

              tdAc.appendChild(document.createElement("div")).className="actions";
              tdAc.firstChild.append(btnToggle, btnPago, btnCobrar);

              tr.append(tdNome, tdSt, tdV, tdA, tdAc);
              tbody.appendChild(tr);
            });
          }

          function refreshPixClientSelect(){
            const sel = $("pixCliente");
            sel.innerHTML = "";
            const opt0 = document.createElement("option");
            opt0.value = "";
            opt0.textContent = "— selecione —";
            sel.appendChild(opt0);
            DATA.clients.forEach(c=>{
              const o = document.createElement("option");
              o.value = c.id;
              o.textContent = c.nome + (c.ativo ? "" : " (inativo)");
              sel.appendChild(o);
            });
          }

          // ---------- PIX (BR Code) ----------
          function emv(id, value){
            const v = String(value ?? "");
            const len = String(v.length).padStart(2,"0");
            return String(id) + len + v;
          }
          function crc16(str){
            // CRC16-CCITT (0x1021), init 0xFFFF
            let crc = 0xFFFF;
            for(let i=0;i<str.length;i++){
              crc ^= (str.charCodeAt(i) << 8);
              for(let j=0;j<8;j++){
                if(crc & 0x8000) crc = ((crc << 1) ^ 0x1021) & 0xFFFF;
                else crc = (crc << 1) & 0xFFFF;
              }
            }
            return crc.toString(16).toUpperCase().padStart(4,"0");
          }
          function buildPixPayload({key, nome, cidade, valor, txid, desc}){
            const gui = emv("00", "br.gov.bcb.pix");
            const k = emv("01", key.trim());
            const d = desc ? emv("02", desc.trim().slice(0, 72)) : "";
            const merchantAcc = emv("26", gui + k + d);

            const amount = valor ? emv("54", Number(valor).toFixed(2)) : "";
            const addData = emv("62", emv("05", (txid || "***").slice(0,25)));

            let payload =
              emv("00","01") +                 // Payload Format Indicator
              emv("01","12") +                 // Point of Initiation Method (12 = static)
              merchantAcc +
              emv("52","0000") +               // Merchant Category Code
              emv("53","986") +                // Currency (BRL)
              amount +
              emv("58","BR") +
              emv("59", safeUpper(nome || "N&V GESTAO DIGITAL")) +
              emv("60", safeUpper(cidade || "SAO PAULO")) +
              addData;

            payload += "6304"; // CRC placeholder
            const c = crc16(payload);
            return payload + c;
          }

          let qrcodeInstance = null;
          function renderQr(text){
            const box = $("qrcode");
            box.innerHTML = "";
            if(!text){
              box.innerHTML = "<div class='hint' style='padding:12px;text-align:center'>Preencha e gere a cobrança.</div>";
              return;
            }
            qrcodeInstance = new QRCode(box, {text, width:150, height:150});
          }

          // ---------- Generate client index ----------
          function slugify(s){
            return String(s||"")
              .toLowerCase()
              .normalize("NFD").replace(/\p{Diacritic}/gu,"")
              .replace(/[^a-z0-9]+/g,"-")
              .replace(/(^-|-$)/g,"")
              .slice(0,40) || ("society-" + Math.random().toString(16).slice(2,8));
          }

          function templateClientIndex(payload){
            // payload: {nome, telefone, endereco, layout, bg, photos:[{img,txt}...]}
            const {nome, telefone, endereco, layout, bg, photos} = payload;
            // Um index simples (placeholder) para você publicar por cliente.
            // Depois conectamos ao sistema de agendamento.
            const cards = (photos||[]).slice(0,6).map((p,i)=>`
              <div class="card">
                <div class="img" style="background-image:url('${p.img||""}')"></div>
                <div class="txt">
                  <b>${(p.txt||("Foto "+(i+1))).replace(/</g,"&lt;")}</b>
                  <small>Atualize fotos e textos no ADM.</small>
                </div>
              </div>
            `).join("");

            const heroStyle = bg ? `background-image: linear-gradient(90deg, rgba(0,0,0,.75), rgba(0,0,0,.35)), url('${bg}'); background-size:cover; background-position:center;` : "";

            return `<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>${nome} — Agendamento Online</title>
<meta name="description" content="Agendamento online do ${nome}. Reserve, pague sinal e receba protocolo."/>
<style>
  :root{--bg:#050806;--card:rgba(255,255,255,.05);--line:rgba(255,255,255,.12);--text:#eef5ff;--green:#22c55e;--radius:18px;--max:1120px}
  *{box-sizing:border-box} body{margin:0;background:radial-gradient(900px 420px at 20% 0%, rgba(34,197,94,.14), transparent 60%), linear-gradient(180deg, #040806, #050b08); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial}
  a{color:inherit;text-decoration:none}
  .wrap{max-width:var(--max);margin:0 auto;padding:18px 16px 60px}
  .top{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 14px;border:1px solid var(--line);border-radius:999px;background:rgba(6,12,10,.65);backdrop-filter:blur(10px);position:sticky;top:12px;z-index:20}
  .brand{display:flex;align-items:center;gap:10px;font-weight:1000}
  .dot{width:10px;height:10px;border-radius:999px;background:var(--green);display:inline-block}
  .btn{display:inline-flex;align-items:center;justify-content:center;padding:12px 14px;border-radius:14px;border:1px solid var(--line);background:rgba(255,255,255,.04);font-weight:950}
  .btn.primary{border:0;color:#05120b;background:linear-gradient(135deg,#34d399,#22c55e)}
  .hero{margin-top:14px;border:1px solid var(--line);border-radius:28px;overflow:hidden;background:rgba(0,0,0,.30)}
  .heroIn{padding:44px 18px;${heroStyle}}
  h1{margin:0 0 10px;font-size:clamp(28px,4vw,52px);line-height:1.02}
  .muted{color:rgba(238,245,255,.78);line-height:1.7;max-width:64ch}
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px}
  @media(max-width:920px){.grid{grid-template-columns:1fr}}
  .card{border:1px solid var(--line);border-radius:var(--radius);background:var(--card);overflow:hidden}
  .img{height:170px;background:#000;background-size:cover;background-position:center}
  .txt{padding:12px}
  .txt b{display:block}
  .txt small{display:block;margin-top:6px;color:rgba(238,245,255,.65);font-weight:850}
  .bar{margin-top:14px;display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;border:1px solid var(--line);border-radius:18px;background:rgba(0,0,0,.22);padding:16px}
</style>
</head>
<body>
<div class="wrap">
  <header class="top">
    <div class="brand"><span class="dot"></span><span>${nome}</span></div>
    <a class="btn primary" href="#" onclick="alert('Em breve: agendamento online integrado.');return false;">Agendar online</a>
  </header>

  <section class="hero">
    <div class="heroIn">
      <h1>Agendamento online do ${nome}</h1>
      <div class="muted">Reserve seu horário, pague o sinal e receba o protocolo. Atendimento organizado e sem furos.</div>
      <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
        <a class="btn primary" href="#" onclick="alert('Em breve: agendamento online integrado.');return false;">Agendar online</a>
        <a class="btn" href="https://wa.me/${(telefone||"").replace(/\D/g,"")}" target="_blank" rel="noreferrer">Chamar no WhatsApp</a>
      </div>
    </div>
  </section>

  <section class="bar">
    <div>
      <b>Endereço</b><div class="muted">${(endereco||"—").replace(/</g,"&lt;")}</div>
    </div>
    <div>
      <b>Telefone</b><div class="muted">${(telefone||"—").replace(/</g,"&lt;")}</div>
    </div>
    <div class="muted">Layout: <b>${layout}</b></div>
  </section>

  <section class="grid">
    ${cards}
  </section>

  <div style="margin-top:18px;color:rgba(238,245,255,.60);font-size:13px;display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap">
    <div>© 2026 N&V Gestão Digital</div>
    <div>AgendeCampo.com.br</div>
  </div>
</div>
</body>
</html>`;
          }

          // ---------- Login / auth ----------
          function setLoggedIn(on){
            $("admLoginView").style.display = on ? "none" : "block";
            $("admDashView").style.display  = on ? "block" : "none";
            $("btnAdmLogout").style.display = on ? "inline-flex" : "none";
          }

          function checkLogin(){
            const flag = sessionStorage.getItem("agc_adm_logged");
            setLoggedIn(flag === "1");
          }

          function doLogin(){
            const email = ($("admEmail").value || "").trim().toLowerCase();
            const pass  = $("admPass").value || "";
            AUTH = loadAuth();
            if(email === AUTH.email.toLowerCase() && pass === AUTH.pass){
              sessionStorage.setItem("agc_adm_logged","1");
              setLoggedIn(true);
              renderAll();
              toast("Bem-vindo, ADM.");
            }else{
              toast("Login inválido.");
            }
          }

          function doLogout(){
            sessionStorage.removeItem("agc_adm_logged");
            setLoggedIn(false);
            toast("Você saiu.");
          }

          function doChangePassword(){
            const email = ($("chgEmail").value || "").trim().toLowerCase();
            const oldp = $("chgOld").value || "";
            const n1 = $("chgNew").value || "";
            const n2 = $("chgNew2").value || "";
            AUTH = loadAuth();

            if(email !== AUTH.email.toLowerCase()){
              toast("E-mail ADM não confere.");
              return;
            }
            if(oldp !== AUTH.pass){
              toast("Senha atual incorreta.");
              return;
            }
            if(n1.length < 6){
              toast("Nova senha deve ter 6+ caracteres.");
              return;
            }
            if(n1 !== n2){
              toast("Confirmação não confere.");
              return;
            }
            saveAuth({email: AUTH.email, pass:n1});
            $("chgOld").value = ""; $("chgNew").value = ""; $("chgNew2").value = "";
            toast("Senha alterada.");
          }

          // ---------- Actions: client save ----------
          async function saveClient(){
            const nome = ($("cliNome").value||"").trim();
            if(!nome){ toast("Informe o nome do society."); return; }
            const id = slugify(nome);

            const telefone = ($("cliTelefone").value||"").trim();
            const endereco = ($("cliEndereco").value||"").trim();
            const layout = $("cliLayout").value;

            const bg = await fileToDataURL(($("cliBg").files||[])[0]);

            const photos = [];
            for(let i=1;i<=6;i++){
              const img = await fileToDataURL(($("p"+i).files||[])[0]);
              const txt = ($("t"+i).value||"").trim();
              photos.push({img, txt});
            }

            // vencimento padrão: dia 10 do mês atual (se já passou, próximo mês)
            const now = new Date();
            const y = now.getFullYear();
            const m = now.getMonth(); // 0-based
            const venc = new Date(y, m, 10);
            if(now > venc) venc.setMonth(venc.getMonth()+1);
            const vencISO = venc.toISOString().slice(0,10);

            const existingIdx = DATA.clients.findIndex(c=>c.id===id);
            const obj = { id, nome, ativo:true, vencimento:vencISO, telefone, endereco, layout, bg, photos, pagoEm:null };
            if(existingIdx >= 0) DATA.clients[existingIdx] = {...DATA.clients[existingIdx], ...obj};
            else DATA.clients.push(obj);

            saveData(DATA);
            renderAll();
            toast("Cliente salvo.");
          }

          function generateIndexForSelected(){
            const nome = ($("cliNome").value||"").trim();
            if(!nome){ toast("Informe o nome do society."); return; }
            const id = slugify(nome);
            const cli = DATA.clients.find(c=>c.id===id);
            if(!cli){
              toast("Salve o cliente antes de gerar o index.");
              return;
            }
            const html = templateClientIndex(cli);
            $("outIndex").value = html;
            toast("Index gerado.");
          }

          function downloadIndex(){
            const out = $("outIndex").value || "";
            if(!out){ toast("Gere o index primeiro."); return; }
            dl("index.html", out);
          }

          // ---------- PIX actions ----------
          function fillPixDefaults(){
            $("pixKey").value = DATA.cfgPix.key || "";
            $("pixNome").value = DATA.cfgPix.nome || "N&V GESTAO DIGITAL";
            $("pixCidade").value = DATA.cfgPix.cidade || "SAO PAULO";
          }

          function setPixFromCfgInputs(){
            DATA.cfgPix.key = ($("cfgPixKey").value||"").trim();
            DATA.cfgPix.nome = ($("cfgPixNome").value||"").trim() || "N&V GESTAO DIGITAL";
            DATA.cfgPix.cidade = ($("cfgPixCidade").value||"").trim() || "SAO PAULO";
            saveData(DATA);
            fillPixDefaults();
            toast("PIX padrão salvo.");
          }

          function resetLocal(){
            if(!confirm("Resetar dados locais do ADM neste navegador?")) return;
            localStorage.removeItem(LS_DATA);
            DATA = loadData();
            renderAll();
            toast("Dados resetados.");
          }

          function gerarPix(){
            const key = ($("pixKey").value||"").trim();
            if(!key){ toast("Informe a chave PIX."); return; }
            const nome = ($("pixNome").value||"").trim() || "N&V GESTAO DIGITAL";
            const cidade = ($("pixCidade").value||"").trim() || "SAO PAULO";
            const valor = ($("pixValor").value||"").trim();
            const txid = ($("pixTxid").value||"").trim() || "***";
            const desc = ($("pixDesc").value||"").trim();

            const payload = buildPixPayload({key, nome, cidade, valor, txid, desc});
            $("pixPayload").value = payload;
            renderQr(payload);

            // salvar último
            DATA.lastPix = { payload, clientId: $("pixCliente").value || "", venc: $("pixVenc").value || "", valor, txid, desc };
            saveData(DATA);
            toast("PIX gerado.");

            const clientId = $("pixCliente").value || "";
            if(clientId){
              const cli = DATA.clients.find(c=>c.id===clientId);
              if(cli && $("pixVenc").value){
                cli.vencimento = $("pixVenc").value;
                saveData(DATA);
                renderAll();
              }
            }
          }

          async function copiarPix(){
            const payload = $("pixPayload").value || "";
            if(!payload){ toast("Gere o PIX primeiro."); return; }
            try{
              await navigator.clipboard.writeText(payload);
              toast("Copiado.");
            }catch(e){
              toast("Não deu para copiar (bloqueio do navegador).");
            }
          }

          function marcarPagoDaTela(){
            const clientId = $("pixCliente").value || "";
            if(!clientId){ toast("Selecione um cliente."); return; }
            const cli = DATA.clients.find(c=>c.id===clientId);
            if(!cli){ toast("Cliente não encontrado."); return; }
            cli.pagoEm = new Date().toISOString();
            // próximo vencimento sugerido: dia 10 do próximo mês
            const dt = new Date();
            dt.setMonth(dt.getMonth()+1);
            const y = dt.getFullYear();
            const m = String(dt.getMonth()+1).padStart(2,"0");
            cli.vencimento = y + "-" + m + "-10";
            saveData(DATA);
            renderAll();
            toast("Pagamento registrado.");
          }

          // ---------- Render all ----------
          function renderAll(){
            DATA = loadData();
            refreshKPIs();
            refreshClientsTable();
            refreshPixClientSelect();

            // Config tab fields
            $("cfgPixKey").value = DATA.cfgPix.key || "";
            $("cfgPixNome").value = DATA.cfgPix.nome || "N&V GESTAO DIGITAL";
            $("cfgPixCidade").value = DATA.cfgPix.cidade || "SAO PAULO";

            fillPixDefaults();

            // restore last pix
            if(DATA.lastPix && DATA.lastPix.payload){
              $("pixPayload").value = DATA.lastPix.payload;
              $("pixCliente").value = DATA.lastPix.clientId || "";
              $("pixVenc").value = DATA.lastPix.venc || "";
              $("pixValor").value = DATA.lastPix.valor || "";
              $("pixTxid").value = DATA.lastPix.txid || "";
              $("pixDesc").value = DATA.lastPix.desc || "";
              renderQr(DATA.lastPix.payload);
            }else{
              renderQr("");
              $("pixPayload").value = "";
            }

            // default date for venc
            if(!$("pixVenc").value) $("pixVenc").value = todayISO();
          }

          // ---------- Events ----------
          $("btnAdmLogin").addEventListener("click", doLogin);
          $("btnAdmLogout").addEventListener("click", doLogout);
          $("btnAdmChange").addEventListener("click", doChangePassword);
          $("btnSalvarCliente").addEventListener("click", saveClient);
          $("btnGerarIndex").addEventListener("click", generateIndexForSelected);
          $("btnBaixarIndex").addEventListener("click", downloadIndex);

          $("btnSalvarCfgPix").addEventListener("click", setPixFromCfgInputs);
          $("btnResetDados").addEventListener("click", resetLocal);

          $("btnGerarPix").addEventListener("click", gerarPix);
          $("btnCopiarPix").addEventListener("click", copiarPix);
          $("btnMarcarPago").addEventListener("click", marcarPagoDaTela);

          document.querySelectorAll(".chip[data-tab]").forEach(ch=>{
            ch.addEventListener("click", ()=> setTab(ch.getAttribute("data-tab")));
          });

          // Open ADM by hash or query
          function maybeScrollAdm(){
            if(location.hash === "#adm"){
              setTimeout(()=> $("admShell").scrollIntoView({behavior:"smooth", block:"start"}), 60);
            }
          }
          window.addEventListener("hashchange", maybeScrollAdm);

          // Boot
          checkLogin();
          if(sessionStorage.getItem("agc_adm_logged")==="1"){ renderAll(); }
          else { renderQr(""); }

          // When logged in, default tab
          setTab("clientes");
          maybeScrollAdm();
        })();
      </script>

</section>
    </main>
  </div>
</body>
</html>
